---
layout: single
title: "Enhancing dingo: from metabolic models reduction to pathways identification"
date: 2024-08-24
author: Sotiris Touliopoulos
author_profile: true
read_time: true
comments: true
share: true
related: true
hidden: false
---


# Enhancing dingo: from metabolic models reduction to pathways prediction

> #### A contribution to the Google Summer of Code 2024 program


## Overview

#### A summary of the implemented methods, integrated into dingo:

- Preprocess for the reduction of metabolic models.
- Inference of pairwise correlated reactions.
- Visualization of a steady-states correlation matrix.
- Clustering of a steady-states correlation matrix.
- Construction of a weighted graph of the model's reactions with the correlation coefficients as weights.


## Preprocess

- Large metabolic models contain numerous reactions and metabolites.
- Sampling the flux space of such models requires significant computational time due to the high dimensionsionality. 
- Model preprocessing can mitigate this issue by removing certain reactions, thus reducing the dimensional space.

A `PreProcess` class was implemented. After initializing an object from this class, 
users can call the `reduce` function to remove 3 types of reactions:

- Blocked reactions: cannot carry a flux in any condition.
- Zero-flux reactions: cannot carry a flux while maintaining at least 90% of the maximum growth rate.
- Metabolically less-efficient reactions: require a reduction in growth rate if used.

Users can choose to remove an additional set of reactions, by setting the `extend` parameter 
of the `reduce` function to `True`. These reactions do not affect the value of the objective function when removed.

Reduction with the `PreProcess` class has been tested with various models, some of which are included in dingoâ€™s publication article too. Figures below show the number of remained reactions, after calling the `reduce` function.

<center>
    <img src="https://sotiristouliopoulos.github.io/dingo/img/reduction_results_plot.png"><br><br>
    <img src="https://sotiristouliopoulos.github.io/dingo/img/reduction_results_plot2.png"><br><br>
</center>


## Correlated Reactions

- Reactions in biochemical pathways can be positively correlated, negatively correlated, or uncorrelated.
- Positive correlation: if reaction A is active, then reaction B is also active and vice versa.
- Negative correlation: if reaction A is active, then reaction B is inactive and vice versa.
- Zero correlation: The status of reaction A is independent of the status of reaction B and vice versa.

A `correlated_reactions` function that calculates reactions steady states using dingo's `PolytopeSampler` class and creates a correlation matrix was implemented. The correlation matrix is based on the pearson correlation coefficient between pairwise reactions. This function also calculates a copula indicator to filter correlations greater than the pearson cutoff.

A `plot_corr_matrix` function to visualize the correlation matrix as a heatmap plot was implemented too.

This figure illustrates a heatmap from a symmetrical correlation matrix without pearson or indicator filtering:
<center>
    <img src="https://sotiristouliopoulos.github.io/dingo/img/corr_matrix_no_cutoffs.png"><br><br>
</center>

This figure illustrates a heatmap from a triangular correlation matrix with both pearson and indicator filtering:
<center>
    <img src="https://sotiristouliopoulos.github.io/dingo/img/corr_matrix_pearson_indicator_triangle.png"><br><br>
</center>


## Clustering

- Clustering based on a dissimilarity matrix reveals groups of reactions with similar correlation values.
- Reactions within the same cluster may contribute to the same pathways.

A `cluster_corr_reactions` function that hierarchically clusters a correlation matrix 
alongside a `plot_dendrogram` function that plots a dendrogram were implemented.

This figure illustrates a dendrogram created from a filtered correlation matrix:
<center>
    <img src="https://sotiristouliopoulos.github.io/dingo/img/dendrogram_pearson.png"><br><br>
</center>

Distinct clusters are observed. Graphs will reveal if these clusters interact with other clusters or reactions.


## Graphs

- Graphs creation can reveal networks of correlated reactions, potentially corresponding to metabolic pathways.

A `graph_corr_matrix` function that creates graphs from a correlation matrix 
alongside a `plot_graph` function that plots the graphs were implemented.

This figure illustrates a graph created from a correlation matrix without pearson or indicator filtering:
<center>
    <img src="https://sotiristouliopoulos.github.io/dingo/img/graph_no_cutoffs.png"><br><br>
</center>

This figure illustrates a subgraph created from a filtered correlation matrix:
<center>
    <img src="https://sotiristouliopoulos.github.io/dingo/img/subgraph_pearson.png"><br><br>
</center>

This subgraph has 9 nodes that correspond to 9 reactions close to each other in the topology of the E. coli core model. These reactions are: `PGI, G6PDH2R, PGL, GND, RPE, RPI, TKT1, TALA, TKT2`. 

The topology of these reactions can be seen in the figure below from `ESCHER`:
<center>
    <img src="https://sotiristouliopoulos.github.io/dingo/img/escher_subgraph.png"><br><br>
</center>

We observe that `PGI` seems to contribute to a different pathway. However it shares a common metabolite with `G6PDH2r`. 
If we apply a stricter pearson cutoff (e.g., 0.99999), this reaction is removed from this subgraph, leaving only the remaining reactions. This is an important observation: looser cutoffs lead to wider sets of connected reactions, forming larger metabolic pathways.

